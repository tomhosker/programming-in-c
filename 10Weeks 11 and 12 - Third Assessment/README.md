There were previous versions of my solution to this problem, but they were too numerous to include here.
